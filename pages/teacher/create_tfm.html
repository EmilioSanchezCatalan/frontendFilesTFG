<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="../../assets/vendor/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="../../assets/vendor/fontawesome/css/all.min.css">
    <link rel="stylesheet" href="../../assets/css/main.css">
    
    <title>Projectos Uja</title>

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="../../assets/vendor/jquery/jquery-3.3.1.min.js"></script>
    <script src="../../assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

  </head>
  <body>

    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-light bg-primary">
      <a class="navbar-brand" href="index.html">
          <img class="logo-img" src="../../assets/img/logo_uja_negativo.png" alt="">
      </a>
      <div class="btn-group ml-auto">
        <button type="button" class="btn btn-outline-light dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
          <i class="fas fa-cogs"></i>
        </button>
        <div class="dropdown-menu dropdown-menu-right">
          <a class="dropdown-item text-danger" href="../../index.html">Cerrar sesión</a>
        </div>
      </div>
    </nav>

    <!-- Content login -->
    <section class="container border p-4">
      <form>
        <div class="form-group row">
          <label for="inputTitle" class="col-sm-12 col-form-label">Título</label>
          <div class="col-sm-12">
            <input type="text" class="form-control" id="inputTitle" placeholder="Título">
          </div>
        </div>
        <div class="form-group row">
          <label for="typeSelect" class="col-sm-12 col-form-label">Tipo de proyecto</label>
          <div class="col-sm-12">
            <select type="password" class="form-control" id="typeSelect" placeholder="Tipo">
              <option>Selecciona tipo</option>
              <option>Universidad</option>
              <option>Empresa</option>
            </select>
          </div>
        </div>
        <div class="form-group row">
          <label for="modeSelect" class="col-sm-12 col-form-label">Modalidad</label>
          <div class="col-sm-12">
            <select class="form-control" id="modeSelect" placeholder="Modalidad">
              <option>Selecciona modalidad</option>
              <option>Investigar</option>
              <option>Profesionalizante</option>
            </select>
          </div>
        </div>
        <div class="form-group row">
          <div class="col-sm-4 col-md-3 col-lg-2">Segundo tutor</div>
          <div class="col-sm-8 col-md-9 col-lg-10">
            <span class="switch switch-sm">
              <input type="checkbox" class="switch" id="tutorCheck">
              <label for="tutorCheck" id="tutorCheck"></label>
            </span>
          </div>
        </div>
        <div class="form-group row">
          <label for="tutorInput" class="col-sm-12 col-form-label">Tutor 2</label>
          <div class="col-sm-12">
            <select class="form-control" id="tutorInput" placeholder="Modalidad">
              <option>Selecciona el tutor</option>
              <option>Emilio Sánchez Catalán | esc00019</option>
            </select>
          </div>
        </div>
        <div class="form-group row">
          <div class="col-sm-4 col-md-3 col-lg-2">Trabajo en equipo</div>
          <div class="col-sm-8 col-md-9 col-lg-10">
            <span class="switch switch-sm">
              <input type="checkbox" class="switch" id="teamCheck">
              <label for="teamCheck"></label>
            </span>
          </div>
        </div>
        <div class="form-group row">
          <label for="inputNumberStudent" class="col-sm-12 col-form-label">Número de alumnos</label>
          <div class="col-sm-12 d-flex">
            <input type="number" value="2" min="2" class="form-control" id="inputNumberStudent" placeholder="Cantidad">
            <button type="button" id="refreshNumberStudents" class="btn btn-secondary ml-2"><i class="fas fa-sync-alt"></i></button>
          </div>
        </div>
        <div class="form-group row">
          <label for="alumnoInput" class="col-sm-12 col-form-label">Alumno <span class="number"></span></label>
          <div class="col-sm-12">
            <select class="form-control" id="alumnoInput">
              <option>Selecciona el alumno</option>
              <option>Emilio Sánchez Catalán | esc00019</option>
              <option>Emilio Sánchez Catalán | esc00019</option>
              <option>Emilio Sánchez Catalán | esc00019</option>
            </select>
          </div>
        </div>
        <div class="form-group row">
          <label for="dedicationSelect" class="col-sm-12 col-form-label">Dedicación</label>
          <div class="col-sm-12">
            <select class="form-control" id="dedicationSelect">
              <option>Tiempo de dedicación</option>
              <option>Tiempo completo</option>
              <option>Tiempo parcial</option>
            </select>
          </div>
        </div>
        <div class="form-group row">
          <label for="dateInitInput" class="col-sm-12 col-form-label">Fecha de inicio</label>
          <div class="col-sm-12 d-flex">
            <input type="date" class="form-control" id="dateInitInput" placeholder="dd/mm/yyyy">
          </div>
        </div>
        <div class="form-group row">
          <label for="dateEndInput" class="col-sm-12 col-form-label">Fecha de fin</label>
          <div class="col-sm-12 d-flex">
            <input type="date" class="form-control" id="dateEndInput" placeholder="dd/mm/yyyy">
          </div>
        </div>
        <div class="form-group row">
          <label for="inputObjectives" class="col-sm-12 col-form-label">Conocimientos/requisitos</label>
          <div class="col-sm-12">
            <textarea class="form-control" id="inputObjectives"></textarea>
          </div>
        </div>
        <div class="form-group row">
          <label for="inputObjectives" class="col-sm-12 col-form-label">Objetivos</label>
          <div class="col-sm-12">
            <textarea class="form-control" id="inputObjectives"></textarea>
          </div>
        </div>
        <div class="form-group row">
          <label for="inputMethod" class="col-sm-12 col-form-label">Metodología</label>
          <div class="col-sm-12">
            <textarea class="form-control" id="inputMethod"></textarea>
          </div>
        </div>
        <div class="form-group row">
          <label for="inputDocsAndForms" class="col-sm-12 col-form-label">Documentos y formatos</label>
          <div class="col-sm-12">
            <textarea class="form-control" id="inputDocsAndForms"></textarea>
          </div>
        </div>
        <div class="form-group row">
          <div class="col-sm-12">
            <button type="submit" class="btn btn-success ">Guardar</button>
          </div>
        </div>
        <div class="form-group row">
          <div class="col-sm-12">
            <a class="btn btn-light" href="index.html">Atras</a>
          </div>
        </div>
      </form>
    </section>
    <script>
      "use strict";
      $(document).ready(function(){

        // Inicialización del estado del formulario
        inputShowHiddenFunction($("#tutorCheck"), $("#tutorInput"));
        inputShowHiddenFunction($("#teamCheck"), $("#inputNumberStudent"));

        // Añade la funcionalidades a un evento
        $("#tutorCheck").click(() => {
          inputShowHiddenFunction($("#tutorCheck"), $("#tutorInput"))
        });
        $("#teamCheck").click(() => {
          inputShowHiddenFunction($("#teamCheck"), $("#inputNumberStudent"))
          initNoTeam($("#teamCheck"));
        });

        $("#refreshNumberStudents").click(() =>{
          generateSelect($("#inputNumberStudent"), $("#alumnoInput").closest(".form-group.row"));
        })

      });

      /**
       * Muestra u oculta un input vinculado a un checkbox
       * @param {HTMLInput} checkbox  checkbox que decidirá si mostrar o no el input
       * @param {HTMLInput} input     input que se mostrará o se ocultará
       */
      function inputShowHiddenFunction(checkbox, input) {
        if(checkbox.is(':checked')) {   
          input.closest(".form-group.row").css('display', 'flex');
        } else {
          input.closest(".form-group.row").css('display', 'none');
        }
      }

      /**
       * Elimina los selectores de grupo y habilita el selector alumno único
       */
      function initNoTeam(checkbox) {
        if(!checkbox.is(':checked')) {
          $("#alumnoInput").closest(".form-group.row").css("display", "flex");
          $("select[id^='alumnoInputL']").closest(".form-group.row").remove();
        } else {
          generateSelect($("#inputNumberStudent"), $("#alumnoInput").closest(".form-group.row"));
        }
      } 

      /**
       * Genera el número de selectores alumno en función del número de alumnos introducidos
       */
      function generateSelect(inputNumber, brotherElement) {
        if (inputNumber.val() > 1) {
          $("select[id^='alumnoInputL']").closest(".form-group.row").remove();
          brotherElement.css("display", "none");
          for( let i = inputNumber.val(); i>=1; i--) {
            var new_element = brotherElement.clone();
            new_element.find("label").attr("for", "alumnoInputL" + i);
            new_element.find(".number").text(i);
            new_element.find("select").attr("id", "alumnoInputL" + i);
            new_element.css("display", "flex");
            brotherElement.after(new_element);
          }
        } else {
          alert('Es necesario que el numero de alumnos sea mayor de 1');
        }
      }


    </script>

    

  </body>
</html>